## 前言

在实际项目中，都会有权限管理控制（菜单权限和数据权限），具体来说就是：不仅要控制一个用户能够访问哪些资源，还要控制用户只能访问资源的哪些数据。

1. 控制访问资源的权限管理，经典的是 RBAC；
2. 控制数据的权限，可以使用 Spring AOP 切面完成

## RBCA

Role_Based Access Control，基于角色的权限访问控制，是一种数据库设计思想，根据设计数据库设计方案，完成项目的权限控制；核心是角色，在数据库数据时一定有角色表

**RBAC 三原则**

1. 最小权限：给角色配置的权限是其完成任务所需要的最小权限集合。
2. 责任分离：通过相互独立互斥的角色共同完成任务
3. 数据抽象：通过权限的抽象来体现，RBAC 支持的数据抽象程度与 RBAC 的实现细节有关

**模型分类**

1. RBAC0：最简单的用户、角色、权限模型，是 RBAC 权限模型中最核心的一部分，后边其他模型都是在此基础上建立。在 RBAC0 中，一个用户可以具备多个角色，一个角色可以具备多个权限，最终用户所具备的权限是用户所具备的角色的权限并集
2. RBAC1：是在 RABC0 的基础上引入了角色继承，让角色有了上下级关系。
3. RBAC2：是在 RBAC0 的基础上进行扩展，引入了静态职责分离和动态职责分离。

   - 静态职责分离：在设置阶段就做好了限制。比如同一用户不能授予互斥的角色，用户只能有有限个角色，用户获得高级权限之前要有低级权限等等。
   - 动态职责分离：在运行阶段进行限制。比如运行时同一用户下 5 个角色中只能同时有 2 个角色激活等等。

4. RBAC3：将 RBAC1 和 RBAC2 结合起来，就形成了 RBAC3。

`我们日常见到的很多权限模型都是在 RBAC 的基础上扩展出来的。例如在有的系统中我们可以见到用户组的概念，就是将用户分组，用户同时具备自身的角色以及分组的角色。`

## ACL

访问控制列表，是一种基于包过滤的访问控制技术，

## 数据规则权限

1. 自定义一个数据权限的注解，比如叫 PermissionData
2. 在对应的资源请求方法，比如商机列表上添加自定义注解 @PermissionData
3. 利用 AOP 抓取到用户对应角色的所有数据规则并进行 SQL 拼接，最终在 SQL 层面实现数据过滤
