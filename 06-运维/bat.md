当前路径：%~dp0
这个参数只能在 bat 文件中在正常使用，在 cmd 窗口直接输入是没用的，在 cmd 中可以使用 cd ./命令查看

### 常用命令

```sh
help                                # 帮助，也可以使用 /?
type                                # 显示文件内的内容
cls                                 # 清除屏幕

cd                                  # 切换目录
md                                  # 创建目录
c: & cd\ & md mp3                   # 切换到 C 盘，并在 C:\ 创建 mp3 文件夹，等同于 c: & md mp3
md c:\mp3                           # 在 C:\ 创建 mp3 文件夹，没有切换目录
pushd c:\mp3                        # 改变当前目录到指定目录，并保存当前的目录在堆栈顶端，常用于需要频繁切换目录的操作
popd                                # 改变当前目录，跳转到堆栈顶端保存的目录，并将堆栈顶端的目录删除

attrib                              # 显示或更改文件属性


:: 更改文件属性。属性解释
  +   设置属性。
  -   清除属性。
  R   只读文件属性。
  A   存档文件属性。
  S   系统文件属性。
  H   隐藏文件属性。
  [drive:][path][filename]
      指定要处理的文件属性。
  /S  处理当前文件夹及其子文件夹中的匹配文件。
  /D  也处理文件夹。
ATTRIB [+R|-R] [+A|-A] [+S|-S] [+H|-H] [[drive:] [path] filename] [/S [/D]]


call                                                 # 从另一个批处理程序调用一个批处理程序，而不停止父批处理程序。
call [drive:][path] filename [<batchparameters>]]    # [drive:][path] filename 指定要调用的批处理程序的位置和名称。batchparameters 指定批处理程序所需的命令行信息（即参数项）。  参数使用%[1-0]接受
call [:<label> [<arguments>]]                        # 调用标签，比如 call :label
goto                                                 # 跳转。和 call 命令区别：call命令对跳转标签的调用，注意调用时必须在标签名前加冒号，而goto是直接跟标签名。
start                                                #


echo	                            # 显示当前echo状态
echo <xxx>                          # 把这条命令后的内容显示到控制台上
echo.	                            # 空白行，echo后紧跟.或,或:或"或[或\或]
echo %变量%                         # 输出变量
echo Y | 	                        # 使用管道命令，将y做为后面执行的输入
echo 文件内容 > 文件名 / echo 文件内容 >> 文件名
echo 内容 >;PRN	                    # 向打印机输出打印内容或打印控制码
echo ^G                             # 产生鸣响，特殊字符

echo off                            # 表示关闭其他所有命令(不包括本身这条命令)的回显
echo on
@echo off                           # 表示执行了这条命令后关闭所有命令(包括本身这条命令)的回显。@的作用就是关闭紧跟其后的一条命令的回显
@echo on



pause                               # 暂停，并打印"请按任意键继续…"，相当于两个功能：1、暂停，2、@echo 请按任意键继续。。。；也可以使用echo 其他提示语 & pause>nul 显示自己的提示语
pause>nul



FIND                                # 在文件中搜索文字字符串
FINDSTR                             # 在文件中搜索字符串


set                                 # 列出变量
set 变量名=变量值                    # 自定义系统变量。注意：两边不能留空格！！！如果变量值为一条命令，则直接通过 %变量值% 即可执行命令
set /p 变量名="请输入变量值: "        # 交互式手动输入
```

### 注释方式

当 echo 处于关闭状态，rem、@rem 和::注释的语句都不会被打印出来；而 echo 处于打开状态时，三者才有不同。

一般情况下，你可以随意使用三种注释方法。不过有时候，你也可以利用三者的不同，使注释按照自己的意愿在需要打印时就打印出来，不需要打印时便不打印。比如 debug 开关，通过参数控制是否打印日志。

```sh
::     # 使用 :: 时，该行完全不会产生任何输出，无论回显状态如何。（echo on 也不会打印出来）
rem	   # 使用 REM 时，尽管该行是注释，但如果回显开启，则会看到该行的内容。（echo on 注释语言会打印出来）
@rem   # 使用 @REM 时，echo on 注释语言也不会打印出来
```

### 组合命令

| 命令                        | 作用                                 |
| --------------------------- | ------------------------------------ |
| 命令 1 & 命令 2&命令 3...   | 命令都会执行                         |
| 命令 1 && 命令 2&&命令 3... | 碰到一个执行错误，后面的就不执行     |
| 命令 1                      | 碰到第一个执行正确，后面不执行       |
|                             | 下面是管道命令                       |
| 命令 1 \| 命令 2 \| 命令 3  | 前面命令的输出做为后面命令的输入     |
| \>, >>                      | \>>表示追加，而>表示对旧的删除后写入 |
| <                           | 从文件中读入命令写入                 |

### if else

```bat
::第一种形式：执行的命令，经常和 call 配合使用，call 将参数传入后用 %1 的形式接收
if [not] "参数" == "字符"
::第二种形式：判断文件是否存在
if [not] exit 文件路径 执行对应命令
::第三种情况
if 条件 (成立时执行的命令) else (不成立时执行的命令)

```

### for

对一组文件中的每一个文件执行某个特定命令。



```sh
for/?       # 帮助命令

for {%variable | %%variable} in (set) do command [command-parameters]
# %variable 指定一个单一字母可替换的参数。变量名称是区分大小写的，所以 %i 不同于 %I 在批处理文件中使用 FOR 命令时，指定变量建议用 %%variable 而不要用 %variable。
# set 指定一个或一组文件。可以使用通配符。
# command 指定对每个文件执行的命令。
# command-parameters 为特定命令指定参数或命令行开关。



如果启用命令扩展，则会支持下列 FOR 命令的其他格式:

FOR /D %variable IN (set) DO command [command-parameters]
# 如果集中包含通配符，则指定与目录名匹配，而不与文件名匹配。

FOR /R [[drive:]path] %variable IN (set) DO command [command-parameters]
# 检查以 [drive:]path 为根的目录树，指向每个目录中的FOR 语句。如果在 /R 后没有指定目录，则使用当前目录。如果集仅为一个单点(.)字符，则枚举该目录树。

FOR /L %variable IN (start,step,end) DO command [command-parameters]
# 该集表示以增量形式从开始到结束的一个数字序列。比如 ，(1,1,5)将产生序列 1 2 3 4 5，(5,-1,1)将产生序列(5 4 3 2 1)

FOR /F ["options"] %variable IN (file-set) DO command [command-parameters]
FOR /F ["options"] %variable IN ("string") DO command [command-parameters]
FOR /F ["options"] %variable IN ('command') DO command [command-parameters]
#  fileset 为一个或多个文件名。继续到 fileset 中的下一个文件之前，每份文件都被打开、读取并经过处理。处理包括读取文件，将其分成一行行的文字，然后将每行解析成零或更多的符号。然后用已找到的符号字符串变量值调用 For 循环。以默认方式，/F 通过每个文件的每一行中分开的第一个空白符号。跳过空白行。你可通过指定可选 "options" 参数替代默认解析操作。这个带引号的字符串包括一个或多个指定不同解析选项的关键字。这些关键字为:

eol=c           # 指一个行注释字符的结尾(就一个)
skip=n          # 指在文件开始时忽略的行数。
delims=xxx      # 指分隔符集。这个替换了空格和制表符的。默认分隔符集。
tokens=x,y,m-n  # 指每行的哪一个符号被传递到每个迭代的 for 本身。这会导致额外变量名称的分配。m-n 格式为一个范围。通过 nth 符号指定 mth。如果符号字符串中的最后一个字符星号，那么额外的变量将在最后一个符号解析之后分配并接受行的保留文本。
usebackq        # 指定新语法已在下类情况中使用:在作为命令执行一个后引号的字符串并且一个单引号字符为文字字符串命令并允许在 file-set中使用双引号扩起文件名称。

示例
FOR /F "eol=; tokens=2,3* delims=, " %i in (myfile.txt) do @echo %i %j %k

```

### choice

返回值是默认在环境变量 errorlevel 中，不需要自己定义返回值；

```sh
# 参数含义：
# /c 后面是实际可输入字符，若没有后面的内容，会自动将每个字符分开作为输入提示，且每个字符自动转为大写
# /n 隐藏默认选项的提示，
# /m 自定义显示自己的提示
choice /c 选项 /n /m 选项对应提示信息

CHOICE /C YN
echo 输入是：%errorlevel%   ::根据上面选择得到不同返回
pause>nul   ::为了不在最后一行显示pause的输出：继续按键。。
```

### 运算符

```bat
:: 等于，一般使用 ==
EQU
:: 不等于，没有 “!=”，改用“ if not 1==1 ”的写法
NEQ
:: 小于
LSS
:: 小于或等于
LEQ
:: 大于
GTR
:: 大于或等于
GEQ
```

### 变量值

```sh

%ALLUSERSPROFILE%       # 本地返回“所有用户”配置文件的位置。
%APPDATA%               # 本地返回默认情况下应用程序存储数据的位置。
%CD%                    # 本地返回当前目录字符串。
%CMDCMDLINE%            # 本地返回用来启动当前的 Cmd.exe 的准确命令行。
%CMDEXTVERSION%         # 系统返回当前的“命令处理程序扩展”的版本号。
%COMPUTERNAME%          # 系统返回计算机的名称。
%COMSPEC%               # 系统返回命令行解释器可执行程序的准确路径。
%DATE%                  # 系统返回当前日期。使用与 date /t 命令相同的格式。由 Cmd.exe 生成。有关 date 命令的详细信息，请参阅 Date。
%ERRORLEVEL%            # 系统返回上一条命令的错误代码。通常用非零值表示错误。
%HOMEDRIVE%             # 系统返回连接到用户主目录的本地工作站驱动器号。基于主目录值而设置。用户主目录是在“本地用户和组”中指定的。
%HOMEPATH%              # 系统返回用户主目录的完整路径。基于主目录值而设置。用户主目录是在“本地用户和组”中指定的。
%HOMESHARE%             # 系统返回用户的共享主目录的网络路径。基于主目录值而设置。用户主目录是在“本地用户和组”中指定的。
%LOGONSERVER%           # 本地返回验证当前登录会话的域控制器的名称。
%NUMBER_OF_PROCESSORS%  # 系统指定安装在计算机上的处理器的数目。
%OS%                    # 系统返回操作系统名称。Windows 2000 显示其操作系统为 Windows_NT。
%PATH%                  # 系统指定可执行文件的搜索路径。
%PATHEXT%               # 系统返回操作系统认为可执行的文件扩展名的列表。
%PROCESSOR_ARCHITECTURE%         # 系统返回处理器的芯片体系结构。值：x86 或 IA64 基于Itanium
%PROCESSOR_IDENTFIER%            # 系统返回处理器说明。
%PROCESSOR_LEVEL%                # 系统返回计算机上安装的处理器的型号。
%PROCESSOR_REVISION%             # 系统返回处理器的版本号。
%PROMPT%                         # 本地返回当前解释程序的命令提示符设置。由 Cmd.exe 生成。
%RANDOM%                         # 系统返回 0 到 32767 之间的任意十进制数字。由 Cmd.exe 生成。
%SYSTEMDRIVE%                    # 系统返回包含 Windows server operating system 根目录（即系统根目录）的驱动器。
%SYSTEMROOT%                     # 系统返回 Windows server operating system 根目录的位置。
%TEMP% 和 %TMP%                  # 系统和用户返回对当前登录用户可用的应用程序所使用的默认临时目录。有些应用程序需要 TEMP，而其他应用程序则需要 TMP。
%TIME%                           # 系统返回当前时间。使用与 time /t 命令相同的格式。由 Cmd.exe 生成。有关time 命令的详细信息，请参阅 Time。
%USERDOMAIN%                     # 本地返回包含用户帐户的域的名称。
%USERNAME%                       # 本地返回当前登录的用户的名称。
%USERPROFILE%                    # 本地返回当前用户的配置文件的位置。
%WINDIR%                         # 系统返回操作系统目录的位置。

变量的显示
在CMD里输入  echo %WINDIR%
这样就能显示一个变量的值了!
举个实际例子,比如我们要复制文件到当前帐号的启动目录里就可以这样
copy d:\1.bat "%USERPROFILE%\「开始」菜单\程序\启动\"
%USERNAME% 本地 返回当前登录的用户的名称。  注意有空格的目录要用引号引起来

```

### 特殊符号

| 符号   | 作用                                                                                                                                                                                   |
| ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| @      | 让后面的命令不显示在窗口，但会执行，一般用于关闭回显@echo off 和不显示注释                                                                                                             |
| %      | 引导 bat 文件的输入变量，%1~9；%\*表示所有变量                                                                                                                                         |
| >,>>   | 覆盖和追加内容到文件                                                                                                                                                                   |
| <      | 从文件中读入                                                                                                                                                                           |
| >&,<&  | 一个句柄写入到另一个，某个数据流输出的地址，（NT CMD 称为句柄，MSDOS 称为设备），常用句柄 0，1，2，分别指：stdin(标准键盘输入)，stdout(标准输出输出到命令提示符窗口)，stderr(标准错误) |
| ^      | 转义字符，放在某些特殊字符前面，><                                                                                                                                                     |
| ,      | 可以认为是空格                                                                                                                                                                         |
| ；     | 命令相同时将多个参数用分号分开                                                                                                                                                         |
| （）   | 必须成对存在，可以包含多行命令                                                                                                                                                         |
| ！和 % | 一对包括变量名，!在延迟变量中使用，setlocal                                                                                                                                            |
| :~     | 用于字符串处理                                                                                                                                                                         |

### 字符串处理

字符串截取、命令嵌套
命令格式：%变量名:~ m,n%,其中，m 表示开始位置(默认开头)，n 表示从 m 位置开始向后截取的字符个数（默认到结尾），若 n 为负数则表示向前截取个数,作用：将命令中的某段字符截取，通过 call 将字符做为命令执行。

```sh
@echo off
set str1=aaa echo ok bbb
echo 初始字符串：%str1%  ::aaa echo ok bbb
echo 生成命令字符串如下：
echo %str1:~4,7%    ::echo ok
echo 运行命令字符串生成最终结果为：
call %str1:~4,7%   ::ok
pause

```

字符串内字符替换
格式：set 变量名=%变量名:n=m%其中 n 表示原来字符串，m 表示用来替换的新字符串；都不需要用引号包裹

```sh
set a="12344567"
echo %a%   ::"12344567"
set a=%a:44=kmk%
echo %a%   ::"123kmk567"
pause

```

字符串合并
格式：set str1=%str1%%str2%

截取字符串传入截取长度

```sh
直接 echo %args:~%num%,-5% 没办法想要的字符串，需要如下两步
setlocal enabledelayedexpansion   ::设置变量延时有效
echo !args:~%num%,-5!       ::变量使用!!包括，%num%变量传入

```


